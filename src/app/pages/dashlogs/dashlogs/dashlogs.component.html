<div class="dash-container">
  <app-header></app-header>

  <div *ngIf="rateLimitMessage" class="rate-limit-msg">
    <p>{{ rateLimitMessage }}</p>
    <button (click)="clearRateLimitMessage()">Cerrar</button>
  </div>
  <app-header></app-header>
<h1>Graficas para monitoreo</h1>
<br>

  <div *ngIf="!rateLimitMessage">

    <div class="stats-cards">
      <p-card header="Total Registros" class="stat-card">{{ totalLogs }}</p-card>
      <p-card header="Rutas Únicas" class="stat-card">{{ uniqueRoutes }}</p-card>
      <p-card header="Usuarios Únicos" class="stat-card">{{ uniqueUsers }}</p-card>
      <p-card header="Tiempo Promedio Respuesta (ms)" class="stat-card">{{ avgResponseTime }}</p-card>
      <p-card header="Tiempo Mínimo Respuesta (ms)" class="stat-card">{{ minResponseTime }}</p-card>
      <p-card header="API Más Consumida" class="stat-card">{{ mostConsumedAPI.route }} ({{ mostConsumedAPI.count }})</p-card>
      <p-card header="API Menos Consumida" class="stat-card">{{ leastConsumedAPI.route }} ({{ leastConsumedAPI.count }})</p-card>
    </div>

    <div class="charts-grid">

      <div class="chart-card">
        <h3>Registros por Día (Línea)</h3>
        <canvas baseChart
          [data]="sessionsChartData"
          [type]="sessionsChartType"
          [options]="sessionsChartOptions">
        </canvas>
      </div>

      <div class="chart-card">
        <h3>Métodos HTTP (Pie)</h3>
        <canvas baseChart
          [data]="methodChartData"
          [type]="methodChartType"
          [options]="methodChartOptions">
        </canvas>
      </div>

      <div class="chart-card">
        <h3>Códigos de Estado (Doughnut)</h3>
        <canvas baseChart
          [data]="statusChartData"
          [type]="statusChartType"
          [options]="statusChartOptions">
        </canvas>
      </div>

      <div class="chart-card">
        <h3>Tendencia Tiempo Respuesta (Barra)</h3>
        <canvas baseChart
          [data]="rtChartData"
          [type]="rtChartType"
          [options]="rtChartOptions">
        </canvas>
      </div>

    </div>
  </div>
</div>
